<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><link rel="icon" type="image/svg+xml" href="/libai.svg"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="msapplication-TileColor" content="#ffffff"><title>瀑布流增加监听器加载图片以及移除瀑布流数据</title><script>!function(){var e=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,t=localStorage.getItem("vueuse-color-scheme")||"auto";("dark"===t||e&&"light"!==t)&&document.documentElement.classList.toggle("dark",!0)}()</script><script type="module" crossorigin="" src="/assets/app-s8jKEiBj.js"></script><link rel="stylesheet" crossorigin="" href="/assets/app-CxjQKUcm.css"><link rel="modulepreload" crossorigin="" href="/assets/waterfall-loadimage-DIX8pNDy.js"><meta property="og:title" content="瀑布流增加监听器加载图片以及移除瀑布流数据"><meta name="twitter:title" content="瀑布流增加监听器加载图片以及移除瀑布流数据"><meta property="og:image" content="https://antfu.me/og/waterfall-loadimage.png"><meta name="twitter:image" content="https://antfu.me/og/waterfall-loadimage.png"><meta name="twitter:card" content="summary_large_image"></head><body class="font-sans text-gray-700 dark:text-gray-200 relative"><div id="app" data-server-rendered="true"><!--[--><header class="header z-40" data-v-dde95c02="" data-v-45b450a6=""><a href="/" class="w-12 h-12 absolute xl:fixed m-5 select-none outline-none" focusable="false" data-v-45b450a6=""><svg viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-45b450a6="" data-v-1d4a309f=""><title data-v-1d4a309f="">Anthony Fu @ antfu.me</title><g data-v-1d4a309f=""><path class="path1" d="M9.03567 15.67H31.9352C27.9984 15.3083 20.0411 12.3011 19.7069 3.16567C19.3727 -5.96973 19.5677 15.9972 19.7069 28.1227L19.4791 15.7733C18.5676 19.6486 14.2308 27.9366 4.17474 30.0861C-5.88131 32.2357 10.3395 21.4399 19.7069 15.7733C23.6185 22.6972 32.5352 35.2532 36.9101 30.0861C41.2849 24.9191 22.2766 26.6242 12.2257 28.1227H26.9983L19.7069 36.235C20.3272 39.1802 21.1956 45.5254 19.7069 47.3442C17.8461 49.6177 8.23817 45.7424 3.26331 39.3869C-1.71154 33.0314 29.9984 34.5815 39.4924 39.3869C48.9864 44.1923 69.5694 5.69753 63.6072 3.16567C57.645 0.633798 28.4034 43.9339 50.7333 45.2257C73.0632 46.5175 69.8353 33.9098 67.4428 25.3841C65.0503 16.8584 54.2651 14.8949 38.9228 28.1227C26.6489 38.7048 57.8602 33.8409 75 30.0861" stroke="black" stroke-width="1.7" stroke-linecap="round" data-v-1d4a309f=""></path></g></svg></a><button title="Scroll to top" fixed="" right-3="" bottom-3="" w-10="" h-10="" hover:op100="" rounded-full="" hover-bg-hex-8883="" transition="" duration-300="" z-100="" print:hidden="" class="op0! pointer-events-none" data-v-45b450a6=""><div i-ri-arrow-up-line="" data-v-45b450a6=""></div></button><nav class="nav" data-v-45b450a6=""><div class="spacer" data-v-45b450a6=""></div><div class="right" print:op0="" data-v-45b450a6=""><a href="/" class="" title="Home" data-v-45b450a6=""><span class="lt-md:hidden" data-v-45b450a6="">Home</span><div i-ri-home-5-line="" md:hidden="" data-v-45b450a6=""></div></a><a href="/posts" class="" title="Blog" data-v-45b450a6=""><span class="lt-md:hidden" data-v-45b450a6="">Blog</span><div i-ri-article-line="" md:hidden="" data-v-45b450a6=""></div></a><a href="/links" class="" title="Links" data-v-45b450a6=""><span class="lt-md:hidden" data-v-45b450a6="">Links</span><div i-ri-shapes-line="" md:hidden="" data-v-45b450a6=""></div></a><a href="/about" class="" title="About" data-v-45b450a6=""><span class="lt-md:hidden" data-v-45b450a6="">About</span><div i-ri-question-line="" md:hidden="" data-v-45b450a6=""></div></a><a class="select-none" title="Toggle Color Scheme" data-v-45b450a6=""><div i-ri-sun-line="" dark:i-ri-moon-line=""></div></a></div></nav></header><main class="px-7 py-10 of-x-hidden" data-v-dde95c02=""><!--[--><!----><div class="prose m-auto mb-8"><h1 class="mb-0 slide-enter-50">瀑布流增加监听器加载图片以及移除瀑布流数据</h1><p class="opacity-50 !-mt-6 slide-enter-50">Mar 31 <span>· 10min</span></p><p class="opacity-50 !-mt-6 slide-enter color-green-400">JavaScript</p><!----><!----><!----></div><article class=""><!--[--><div class="prose m-auto slide-enter-content"><p></p><div class="table-of-contents"><div class="table-of-contents-anchor"><div class="i-ri-menu-2-fill"></div></div><ul><li><a href="#瀑布流改进-增加监听时间加载图片保证渲染时能获取正确的元素高度">瀑布流改进-增加监听时间加载图片保证渲染时能获取正确的元素高度</a><ul><li><a href="#实例效果预览图">实例效果预览图</a></li><li><a href="#template-and-css">Template and CSS</a></li><li><a href="#script">Script</a></li></ul></li></ul></div><p></p><h2 id="瀑布流改进-增加监听时间加载图片保证渲染时能获取正确的元素高度" tabindex="-1">瀑布流改进-增加监听时间加载图片保证渲染时能获取正确的元素高度 <a class="header-anchor" href="#瀑布流改进-增加监听时间加载图片保证渲染时能获取正确的元素高度" aria-hidden="true">#</a></h2><hr><p>当瀑布流中的元素包含图片并且尺寸不明确的时候(更佳的做法是在图片文件中包含图片尺寸信息，来提升前端的渲染体验)，监听每一次图片加载的load状态，当图片loaded，则进行获取高度插入下一组瀑布流数据。</p><p>在上次基础上进行一些改动，下面是代码，还增加了reduce的生成器，用于处理移除瀑布流数据的情况。</p><h3 id="实例效果预览图" tabindex="-1">实例效果预览图 <a class="header-anchor" href="#实例效果预览图" aria-hidden="true">#</a></h3><p><img src="/assets/waterfall-B0slUQSe.png" alt="实例展示效果"></p><h3 id="template-and-css" tabindex="-1">Template and CSS <a class="header-anchor" href="#template-and-css" aria-hidden="true">#</a></h3><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-html"><span class="line"><span style="--s-dark:#666666;--s-light:#999999"> &lt;</span><span style="--s-dark:#4D9375;--s-light:#1E754F">div</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> class</span><span style="--s-dark:#666666;--s-light:#999999">=</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">content</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">"</span><span style="--s-dark:#666666;--s-light:#999999">&gt;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    &lt;</span><span style="--s-dark:#4D9375;--s-light:#1E754F">div</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> class</span><span style="--s-dark:#666666;--s-light:#999999">=</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">list</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">"</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> ref</span><span style="--s-dark:#666666;--s-light:#999999">=</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">l1</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">"</span><span style="--s-dark:#666666;--s-light:#999999">&gt;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">      &lt;</span><span style="--s-dark:#FDAEB7;--s-light:#B31D28">TransitionGroup</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> name</span><span style="--s-dark:#666666;--s-light:#999999">=</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">add</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">"</span><span style="--s-dark:#666666;--s-light:#999999">&gt;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">        &lt;</span><span style="--s-dark:#4D9375;--s-light:#1E754F">div</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> class</span><span style="--s-dark:#666666;--s-light:#999999">=</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">item</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">"</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> v-for</span><span style="--s-dark:#666666;--s-light:#999999">=</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">(i1, index1) in list1</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">"</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> :key</span><span style="--s-dark:#666666;--s-light:#999999">=</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">index1</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">"</span><span style="--s-dark:#666666;--s-light:#999999">&gt;&lt;</span><span style="--s-dark:#4D9375;--s-light:#1E754F">img</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> :src</span><span style="--s-dark:#666666;--s-light:#999999">=</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">i1.img</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">"</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> ref</span><span style="--s-dark:#666666;--s-light:#999999">=</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">imgs</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">"</span><span style="--s-dark:#666666;--s-light:#999999">&gt;</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34">{{</span></span>
<span class="line"><span style="--s-dark:#DBD7CAEE;--s-light:#393A34">          i1.text }}</span><span style="--s-dark:#666666;--s-light:#999999">&lt;/</span><span style="--s-dark:#4D9375;--s-light:#1E754F">div</span><span style="--s-dark:#666666;--s-light:#999999">&gt;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">      &lt;/</span><span style="--s-dark:#FDAEB7;--s-light:#B31D28">TransitionGroup</span><span style="--s-dark:#666666;--s-light:#999999">&gt;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    &lt;/</span><span style="--s-dark:#4D9375;--s-light:#1E754F">div</span><span style="--s-dark:#666666;--s-light:#999999">&gt;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    &lt;</span><span style="--s-dark:#4D9375;--s-light:#1E754F">div</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> class</span><span style="--s-dark:#666666;--s-light:#999999">=</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">list</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">"</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> ref</span><span style="--s-dark:#666666;--s-light:#999999">=</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">l2</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">"</span><span style="--s-dark:#666666;--s-light:#999999">&gt;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">      &lt;</span><span style="--s-dark:#FDAEB7;--s-light:#B31D28">TransitionGroup</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> name</span><span style="--s-dark:#666666;--s-light:#999999">=</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">add</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">"</span><span style="--s-dark:#666666;--s-light:#999999">&gt;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">        &lt;</span><span style="--s-dark:#4D9375;--s-light:#1E754F">div</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> class</span><span style="--s-dark:#666666;--s-light:#999999">=</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">item</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">"</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> v-for</span><span style="--s-dark:#666666;--s-light:#999999">=</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">(i2, index2) in list2</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">"</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> :key</span><span style="--s-dark:#666666;--s-light:#999999">=</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">index2</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">"</span><span style="--s-dark:#666666;--s-light:#999999">&gt;&lt;</span><span style="--s-dark:#4D9375;--s-light:#1E754F">img</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> :src</span><span style="--s-dark:#666666;--s-light:#999999">=</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">i2.img</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">"</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> ref</span><span style="--s-dark:#666666;--s-light:#999999">=</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">imgs</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">"</span><span style="--s-dark:#666666;--s-light:#999999">&gt;</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34">{{ i2.text }}</span><span style="--s-dark:#666666;--s-light:#999999">&lt;/</span><span style="--s-dark:#4D9375;--s-light:#1E754F">div</span><span style="--s-dark:#666666;--s-light:#999999">&gt;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">      &lt;/</span><span style="--s-dark:#FDAEB7;--s-light:#B31D28">TransitionGroup</span><span style="--s-dark:#666666;--s-light:#999999">&gt;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    &lt;/</span><span style="--s-dark:#4D9375;--s-light:#1E754F">div</span><span style="--s-dark:#666666;--s-light:#999999">&gt;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  &lt;/</span><span style="--s-dark:#4D9375;--s-light:#1E754F">div</span><span style="--s-dark:#666666;--s-light:#999999">&gt;</span></span></code></pre><h3 id="script" tabindex="-1">Script <a class="header-anchor" href="#script" aria-hidden="true">#</a></h3><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-typescript"><span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">import</span><span style="--s-dark:#666666;--s-light:#999999"> {</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> onMounted</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> ref</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> watch</span><span style="--s-dark:#666666;--s-light:#999999"> }</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> from</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999"> '</span><span style="--s-dark:#C98A7D;--s-light:#B56959">vue</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">interface</span><span style="--s-dark:#5DA994;--s-light:#2E8F82"> Data</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">  text</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82">string</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">  img</span><span style="--s-dark:#CB7676;--s-light:#AB5959">?</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82">string</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const </span><span style="--s-dark:#BD976A;--s-light:#B07D48">data</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#80A665;--s-light:#59873A"> ref</span><span style="--s-dark:#666666;--s-light:#999999">&lt;</span><span style="--s-dark:#5DA994;--s-light:#2E8F82">Data</span><span style="--s-dark:#666666;--s-light:#999999">[]&gt;([</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  { </span><span style="--s-dark:#B8A965;--s-light:#998418">text</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span><span style="--s-dark:#C98A7D;--s-light:#B56959">图文一</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span><span style="--s-dark:#666666;--s-light:#999999">, </span><span style="--s-dark:#B8A965;--s-light:#998418">img</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span><span style="--s-dark:#C98A7D;--s-light:#B56959">https://live.mdnplay.dev/zh-CN/docs/Web/HTML/Element/img/favicon144.png</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span><span style="--s-dark:#666666;--s-light:#999999"> },</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  { </span><span style="--s-dark:#B8A965;--s-light:#998418">text</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span><span style="--s-dark:#C98A7D;--s-light:#B56959">图文二图文二</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span><span style="--s-dark:#666666;--s-light:#999999"> ,</span><span style="--s-dark:#B8A965;--s-light:#998418">img</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span><span style="--s-dark:#C98A7D;--s-light:#B56959">https://live.mdnplay.dev/zh-CN/docs/Web/HTML/Element/img/clock-demo-400px.png</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span><span style="--s-dark:#666666;--s-light:#999999">},</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  { </span><span style="--s-dark:#B8A965;--s-light:#998418">text</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span><span style="--s-dark:#C98A7D;--s-light:#B56959">图文三图文三图文三</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span><span style="--s-dark:#666666;--s-light:#999999"> ,</span><span style="--s-dark:#B8A965;--s-light:#998418">img</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span><span style="--s-dark:#C98A7D;--s-light:#B56959">https://interactive-examples.mdn.mozilla.net/media/cc0-images/grapefruit-slice-332-332.jpg</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span><span style="--s-dark:#666666;--s-light:#999999">},</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  { </span><span style="--s-dark:#B8A965;--s-light:#998418">text</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span><span style="--s-dark:#C98A7D;--s-light:#B56959">图文四图文四图文四图文四</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span><span style="--s-dark:#666666;--s-light:#999999"> ,</span><span style="--s-dark:#B8A965;--s-light:#998418">img</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span><span style="--s-dark:#C98A7D;--s-light:#B56959">https://interactive-examples.mdn.mozilla.net/media/examples/balloon-small.jpg</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span><span style="--s-dark:#666666;--s-light:#999999">},</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  { </span><span style="--s-dark:#B8A965;--s-light:#998418">text</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span><span style="--s-dark:#C98A7D;--s-light:#B56959">图文五图文五图文五图文五图文五</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span><span style="--s-dark:#666666;--s-light:#999999"> ,</span><span style="--s-dark:#B8A965;--s-light:#998418">img</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">''</span><span style="--s-dark:#666666;--s-light:#999999">}</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">])</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const </span><span style="--s-dark:#BD976A;--s-light:#B07D48">imgs</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#80A665;--s-light:#59873A"> ref</span><span style="--s-dark:#666666;--s-light:#999999">([])</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const </span><span style="--s-dark:#BD976A;--s-light:#B07D48">i</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#80A665;--s-light:#59873A"> ref</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#4C9A91;--s-light:#2F798A">0</span><span style="--s-dark:#666666;--s-light:#999999">)</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const </span><span style="--s-dark:#BD976A;--s-light:#B07D48">list1</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#80A665;--s-light:#59873A"> ref</span><span style="--s-dark:#666666;--s-light:#999999">&lt;</span><span style="--s-dark:#5DA994;--s-light:#2E8F82">Data</span><span style="--s-dark:#666666;--s-light:#999999">[]&gt;([])</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const </span><span style="--s-dark:#BD976A;--s-light:#B07D48">list2</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#80A665;--s-light:#59873A"> ref</span><span style="--s-dark:#666666;--s-light:#999999">&lt;</span><span style="--s-dark:#5DA994;--s-light:#2E8F82">Data</span><span style="--s-dark:#666666;--s-light:#999999">[]&gt;([])</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const </span><span style="--s-dark:#BD976A;--s-light:#B07D48">l1</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#80A665;--s-light:#59873A"> ref</span><span style="--s-dark:#666666;--s-light:#999999">()</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const </span><span style="--s-dark:#BD976A;--s-light:#B07D48">l2</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#80A665;--s-light:#59873A"> ref</span><span style="--s-dark:#666666;--s-light:#999999">()</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">function</span><span style="--s-dark:#4D9375;--s-light:#1E754F">*</span><span style="--s-dark:#80A665;--s-light:#59873A"> addData</span><span style="--s-dark:#666666;--s-light:#999999">()</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">i</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">value</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> !=</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> data</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">value</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#B8A965;--s-light:#998418">length</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">    if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">l1</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">value</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">offsetHeight</span><span style="--s-dark:#666666;--s-light:#999999"> &lt;=</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> l2</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">value</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">offsetHeight</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">      yield</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> list1</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">value</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">push</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">data</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">value</span><span style="--s-dark:#666666;--s-light:#999999">[</span><span style="--s-dark:#BD976A;--s-light:#B07D48">i</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">value</span><span style="--s-dark:#CB7676;--s-light:#AB5959">++</span><span style="--s-dark:#666666;--s-light:#999999">])</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    }</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> else</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">      yield</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> list2</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">value</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">push</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">data</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">value</span><span style="--s-dark:#666666;--s-light:#999999">[</span><span style="--s-dark:#BD976A;--s-light:#B07D48">i</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">value</span><span style="--s-dark:#CB7676;--s-light:#AB5959">++</span><span style="--s-dark:#666666;--s-light:#999999">])</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    }</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  }</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">function</span><span style="--s-dark:#4D9375;--s-light:#1E754F">*</span><span style="--s-dark:#80A665;--s-light:#59873A"> reduceData</span><span style="--s-dark:#666666;--s-light:#999999">()</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">i</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">value</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> !=</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> -</span><span style="--s-dark:#4C9A91;--s-light:#2F798A">1</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">    if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">l1</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">value</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">offsetHeight</span><span style="--s-dark:#666666;--s-light:#999999"> &gt;</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> l2</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">value</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">offsetHeight</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">      i</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">value</span><span style="--s-dark:#CB7676;--s-light:#AB5959">--</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">      yield</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> list1</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">value</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">splice</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">list1</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">value</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#B8A965;--s-light:#998418">length</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> -</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 1</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 1</span><span style="--s-dark:#666666;--s-light:#999999">)</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    }</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> else</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">      i</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">value</span><span style="--s-dark:#CB7676;--s-light:#AB5959">--</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">      yield</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> list2</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">value</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">splice</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">list2</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">value</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#B8A965;--s-light:#998418">length</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> -</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 1</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 1</span><span style="--s-dark:#666666;--s-light:#999999">)</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    }</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  }</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A">watch</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">i</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">newV</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> oldV</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">  console</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">log</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">l1</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">value</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">offsetHeight</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> l2</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">value</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">offsetHeight</span><span style="--s-dark:#666666;--s-light:#999999">)</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">newV</span><span style="--s-dark:#666666;--s-light:#999999"> &gt;</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> oldV</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A">    setTimeout</span><span style="--s-dark:#666666;--s-light:#999999">(()</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">      console</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">log</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">imgs</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">value</span><span style="--s-dark:#666666;--s-light:#999999">)</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">      imgs</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">value</span><span style="--s-dark:#666666;--s-light:#999999">[</span><span style="--s-dark:#BD976A;--s-light:#B07D48">imgs</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">value</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#B8A965;--s-light:#998418">length</span><span style="--s-dark:#CB7676;--s-light:#AB5959">-</span><span style="--s-dark:#4C9A91;--s-light:#2F798A">1</span><span style="--s-dark:#666666;--s-light:#999999">].</span><span style="--s-dark:#80A665;--s-light:#59873A">addEventListener</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">load</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">"</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#666666;--s-light:#999999"> ()</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">        console</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">log</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span><span style="--s-dark:#C98A7D;--s-light:#B56959">loaded</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span><span style="--s-dark:#666666;--s-light:#999999">)</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A">        addData</span><span style="--s-dark:#666666;--s-light:#999999">().</span><span style="--s-dark:#80A665;--s-light:#59873A">next</span><span style="--s-dark:#666666;--s-light:#999999">()</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">      });</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    },</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 120</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  }</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> else</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A">    setTimeout</span><span style="--s-dark:#666666;--s-light:#999999">(()</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A">      reduceData</span><span style="--s-dark:#666666;--s-light:#999999">().</span><span style="--s-dark:#80A665;--s-light:#59873A">next</span><span style="--s-dark:#666666;--s-light:#999999">()</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    },</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 200</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">})</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A">onMounted</span><span style="--s-dark:#666666;--s-light:#999999">(()</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A">  addData</span><span style="--s-dark:#666666;--s-light:#999999">().</span><span style="--s-dark:#80A665;--s-light:#59873A">next</span><span style="--s-dark:#666666;--s-light:#999999">()</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">})</span></span>
<span class="line"></span></code></pre></div><!--]--></article><div class="prose m-auto mt-8 mb-8 slide-enter animate-delay-500 print:hidden"><span font-mono="" op50="">&gt; </span><a href="/posts" class="font-mono op50 hover:op75"></a></div><!--]--></main><!--]--></div></body></html>