<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><link rel="icon" type="image/svg+xml" href="/libai.svg"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="msapplication-TileColor" content="#ffffff"><title>JavaScript Closure-JS闭包</title><script>!function(){var e=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,t=localStorage.getItem("vueuse-color-scheme")||"auto";("dark"===t||e&&"light"!==t)&&document.documentElement.classList.toggle("dark",!0)}()</script><script type="module" crossorigin="" src="/assets/app-DckgGu54.js"></script><link rel="stylesheet" crossorigin="" href="/assets/app-CGINpirc.css"><link rel="modulepreload" crossorigin="" href="/assets/closure-JuWP16KN.js"><meta property="og:title" content="JavaScript Closure-JS闭包"><meta name="twitter:title" content="JavaScript Closure-JS闭包"><meta property="og:image" content="https://antfu.me/og/closure.png"><meta name="twitter:image" content="https://antfu.me/og/closure.png"><meta name="twitter:card" content="summary_large_image"></head><body class="font-sans text-gray-700 dark:text-gray-200 relative"><div id="app" data-server-rendered="true"><!--[--><header class="header z-40" data-v-dde95c02="" data-v-45b450a6=""><a href="/" class="w-12 h-12 absolute xl:fixed m-5 select-none outline-none" focusable="false" data-v-45b450a6=""><svg viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-45b450a6="" data-v-1d4a309f=""><title data-v-1d4a309f="">Anthony Fu @ antfu.me</title><g data-v-1d4a309f=""><path class="path1" d="M9.03567 15.67H31.9352C27.9984 15.3083 20.0411 12.3011 19.7069 3.16567C19.3727 -5.96973 19.5677 15.9972 19.7069 28.1227L19.4791 15.7733C18.5676 19.6486 14.2308 27.9366 4.17474 30.0861C-5.88131 32.2357 10.3395 21.4399 19.7069 15.7733C23.6185 22.6972 32.5352 35.2532 36.9101 30.0861C41.2849 24.9191 22.2766 26.6242 12.2257 28.1227H26.9983L19.7069 36.235C20.3272 39.1802 21.1956 45.5254 19.7069 47.3442C17.8461 49.6177 8.23817 45.7424 3.26331 39.3869C-1.71154 33.0314 29.9984 34.5815 39.4924 39.3869C48.9864 44.1923 69.5694 5.69753 63.6072 3.16567C57.645 0.633798 28.4034 43.9339 50.7333 45.2257C73.0632 46.5175 69.8353 33.9098 67.4428 25.3841C65.0503 16.8584 54.2651 14.8949 38.9228 28.1227C26.6489 38.7048 57.8602 33.8409 75 30.0861" stroke="black" stroke-width="1.7" stroke-linecap="round" data-v-1d4a309f=""></path></g></svg></a><button title="Scroll to top" fixed="" right-3="" bottom-3="" w-10="" h-10="" hover:op100="" rounded-full="" hover-bg-hex-8883="" transition="" duration-300="" z-100="" print:hidden="" class="op0! pointer-events-none" data-v-45b450a6=""><div i-ri-arrow-up-line="" data-v-45b450a6=""></div></button><nav class="nav" data-v-45b450a6=""><div class="spacer" data-v-45b450a6=""></div><div class="right" print:op0="" data-v-45b450a6=""><a href="/" class="" title="Home" data-v-45b450a6=""><span class="lt-md:hidden" data-v-45b450a6="">Home</span><div i-ri-home-5-line="" md:hidden="" data-v-45b450a6=""></div></a><a href="/posts" class="" title="Blog" data-v-45b450a6=""><span class="lt-md:hidden" data-v-45b450a6="">Blog</span><div i-ri-article-line="" md:hidden="" data-v-45b450a6=""></div></a><a href="/links" class="" title="Links" data-v-45b450a6=""><span class="lt-md:hidden" data-v-45b450a6="">Links</span><div i-ri-shapes-line="" md:hidden="" data-v-45b450a6=""></div></a><a href="/about" class="" title="About" data-v-45b450a6=""><span class="lt-md:hidden" data-v-45b450a6="">About</span><div i-ri-question-line="" md:hidden="" data-v-45b450a6=""></div></a><a class="select-none" title="Toggle Color Scheme" data-v-45b450a6=""><div i-ri-sun-line="" dark:i-ri-moon-line=""></div></a></div></nav></header><main class="px-7 py-10 of-x-hidden" data-v-dde95c02=""><!--[--><!----><div class="prose m-auto mb-8"><h1 class="mb-0 slide-enter-50">JavaScript Closure-JS闭包</h1><p class="opacity-50 !-mt-6 slide-enter-50">Apr 14 <span>· 10min</span></p><p class="opacity-50 !-mt-6 slide-enter color-green-400">JavaScript</p><!----><!----><!----></div><article class=""><!--[--><div class="prose m-auto slide-enter-content"><h1 id="闭包" tabindex="-1">闭包 <a class="header-anchor" href="#闭包" aria-hidden="true">#</a></h1><h2 id="闭包的定义" tabindex="-1">闭包的定义 <a class="header-anchor" href="#闭包的定义" aria-hidden="true">#</a></h2><p>闭包（closure）是一个函数以及其捆绑的周边环境状态（lexical environment，词法环境）的引用的组合。换而言之，闭包让开发者可以从内部函数访问外部函数的作用域。在 JavaScript 中，闭包会随着函数的创建而被同时创建。</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-javascript"><span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">function</span><span style="--s-dark:#80A665;--s-light:#59873A"> fun</span><span style="--s-dark:#666666;--s-light:#999999">(){</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">	let</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> name</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999"> '</span><span style="--s-dark:#C98A7D;--s-light:#B56959">Carlos</span><span style="--s-dark:#C98A7D99;--s-light:#B5695999">'</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">	return</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> function</span><span style="--s-dark:#80A665;--s-light:#59873A"> getName</span><span style="--s-dark:#666666;--s-light:#999999">(){</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">		console</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">log</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">name</span><span style="--s-dark:#666666;--s-light:#999999">)</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">	}</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A">	getName</span><span style="--s-dark:#666666;--s-light:#999999">()</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span></span></code></pre><p>函数fun中，定义了变量name和函数getName，getName可以使用函数fun中的变量name，它就是一个闭包。</p><h2 id="闭包的使用场景" tabindex="-1">闭包的使用场景 <a class="header-anchor" href="#闭包的使用场景" aria-hidden="true">#</a></h2><p>1.创造一个不受外部影响的作用域，作为私有属性来使用。 2.IIFE（自执行函数） 3.函数作为参数（回调函数） 4.将数据常驻内存（防止被GC）</p><h2 id="闭包的清除" tabindex="-1">闭包的清除 <a class="header-anchor" href="#闭包的清除" aria-hidden="true">#</a></h2><p>上述例子中，可以用fun=null，来清除闭包，GC机制会在适当时机释放内存。</p></div><!--]--></article><div class="prose m-auto mt-8 mb-8 slide-enter animate-delay-500 print:hidden"><span font-mono="" op50="">&gt; </span><a href="/posts" class="font-mono op50 hover:op75"></a></div><!--]--></main><!--]--></div></body></html>